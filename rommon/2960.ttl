; =========================
; C2960 Rommon Wipe
; =========================
; - 2960 units are not write-protected
; - Wipe a set of common files, including configs
; - Boot and clear remainder dynamically
;--------------------------------------

newstat = #10'Entering 2960.ttl'
include db

timeout = 0
setsync 1

; Init flash
sendln 'flash_init'
;waitregex 'MORE' '^switch:\s$' 'already initialized\.$' ; Sync will match prompt for most recent command without EOL
;if result = 1 then
;	send ' '
;	pause 1
;	send ' ' ; Seems to skip sometimes.+
;endif

do
	waitregex 'MORE' '^switch:\s$' 'already initialized\.$'
	if result = 1 send ' '
loop while result = 1

; .=========================
; | Wipe common files
; '=========================
include 'rommon\files.ttl'

; .=========================
; | Boot & wait for prompt
; '=========================
sendln 'boot'

newstat = #10'Booting SWITCH...'
include stat

wait 'Press RETURN'
send #13 ;ASCII CR

newstat = ' done!'
include stat

exit
